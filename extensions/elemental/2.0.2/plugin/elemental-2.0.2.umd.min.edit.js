(("undefined"!==typeof self?self:this)["webpackJsonpelemental_2_0_2"]=("undefined"!==typeof self?self:this)["webpackJsonpelemental_2_0_2"]||[]).push([[2],{"0f86":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e._self._c;return e.value?a("CruResource",{attrs:{"done-route":e.doneRoute,"can-yaml":!0,mode:e.mode,resource:e.value,errors:e.errors},on:{error:a=>e.errors=a,finish:e.save,cancel:e.done}},[a("div",{staticClass:"row mt-40 mb-20"},[a("div",{staticClass:"col span-12 mb-20"},[a("h3",[e._v(e._s(e.t("elemental.osversionchannels.create.configuration")))]),a("NameNsDescription",{attrs:{mode:e.mode,"description-hidden":!0,namespaced:!1},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)]),e.value.spec?a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-8 mb-20"},[a("h3",[e._v(e._s(e.t("elemental.osversionchannels.create.spec")))]),a("LabeledInput",{attrs:{"data-testid":"os-version-channel-path",label:e.t("elemental.osversionchannels.create.registryUri.label"),placeholder:e.t("elemental.osversionchannels.create.registryUri.placeholder",null,!0),mode:e.mode},model:{value:e.value.spec.options.image,callback:function(a){e.$set(e.value.spec.options,"image","string"===typeof a?a.trim():a)},expression:"value.spec.options.image"}}),e.supportsNoLongerInSyncChannelDeletion?a("Checkbox",{staticClass:"mt-20",attrs:{mode:e.mode,label:e.t("elemental.osversionchannels.create.automaticDelete"),"data-testid":"os-version-channel-automatic-deletion"},model:{value:e.value.spec.deleteNoLongerInSyncVersions,callback:function(a){e.$set(e.value.spec,"deleteNoLongerInSyncVersions",a)},expression:"value.spec.deleteNoLongerInSyncVersions"}}):e._e()],1)]):e._e()]):a("Loading")},n=[],l=t("15ca"),i=t("fd5f"),o=t("305c"),r=t("8e93"),c=t("3c8c"),d=t("1032"),u=t("193e"),m={name:"ManagedOsVersionChannelEditView",components:{Loading:l["a"],LabeledInput:r["a"],CruResource:i["a"],NameNsDescription:c["a"],Checkbox:d["a"]},mixins:[o["a"]],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},resource:{type:String,required:!0}},async fetch(){this.operatorVersion=await Object(u["i"])(this.$store)},data(){return{operatorVersion:""}},computed:{supportsNoLongerInSyncChannelDeletion(){return Object(u["h"])(this.resource,this.mode,u["f"],this.operatorVersion)}}},h=m,v=t("d802"),p=Object(v["a"])(h,s,n,!1,null,null,null);a["default"]=p.exports},"3af8":function(e,a,t){var s=t("5eaa");a=s(!1),a.push([e.i,".user-warn[data-v-30d4118f]{font-size:13px;color:var(--darker)}",""]),e.exports=a},"429d":function(e,a,t){"use strict";t("84af")},"84af":function(e,a,t){var s=t("3af8");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var n=t("0ed3").default;n("0bd3d98e",s,!0,{sourceMap:!1,shadowMode:!1})},a6ba:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e._self._c;return e.value?a("CruResource",{attrs:{"done-route":e.doneRoute,"can-yaml":!0,mode:e.mode,resource:e.value,errors:e.errors,"validation-passed":e.isFormValid},on:{error:a=>e.errors=a,finish:e.save,cancel:e.done}},[a("div",{staticClass:"row mb-40",class:{"mt-40":!e.hasBeenCreated}},[a("div",{staticClass:"col span-12"},[a("h3",[e._v(e._s(e.t("elemental.machineRegistration.create.configuration")))]),a("NameNsDescription",{attrs:{mode:e.mode,"description-hidden":!0,namespaced:!1},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)]),a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-6"},[a("h3",[e._v(e._s(e.t("elemental.machineRegistration.create.cloudConfiguration")))]),a("YamlEditor",{key:e.rerender,ref:"yamleditor",staticClass:"mb-20",attrs:{"editor-mode":e.editorMode},model:{value:e.cloudConfig,callback:function(a){e.cloudConfig=a},expression:"cloudConfig"}}),e.isView?e._e():a("div",{staticClass:"mb-20"},[a("FileSelector",{staticClass:"btn role-secondary",attrs:{"data-testid":"read-from-file-btn",label:e.t("elemental.machineRegistration.create.readFromFile")},on:{selected:e.onFileSelected}})],1),e._l(e.yamlErrors,(function(e,t){return a("Banner",{key:t,attrs:{color:"error",label:e}})}))],2)]),a("div",{staticClass:"row mb-40"},[a("div",{staticClass:"col span-12"},[a("h3",{staticClass:"mt-10"},[e._v(" "+e._s(e.t("elemental.machineRegistration.create.labelsAndAnnotations"))+" ")]),a("Tabbed",{attrs:{"data-testid":"labels-and-annotations-block"}},[a("Tab",{attrs:{"label-key":"elemental.machineRegistration.create.machineInv",name:"machine-inventory","data-testid":"mach-inv-tab",weight:3}},[a("Banner",{staticClass:"mb-40",attrs:{color:"info","data-testid":"mach-inv-banner"}},[a("div",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("elemental.machineRegistration.create.labelsAndAnnotationsMachInvBanner",{},!0),expression:"t('elemental.machineRegistration.create.labelsAndAnnotationsMachInvBanner', {}, true)"}]})]),a("div",{staticClass:"row mb-30"},[a("KeyValue",{key:"labels",attrs:{"data-testid":"add-label-mach-inv",value:e.value.machineInventoryLabels,"add-label":e.t("labels.addLabel"),mode:e.mode,title:e.t("labels.labels.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.updateLabels(a)}}})],1),a("div",{staticClass:"row mb-10"},[a("KeyValue",{key:"annotations",attrs:{"data-testid":"add-annotation-mach-inv",value:e.value.machineInventoryAnnotations,"add-label":e.t("labels.addAnnotation"),mode:e.mode,title:e.t("labels.annotations.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.value.setAnnotations(a,"machineInventoryAnnotations",!0)}}})],1)],1),a("Tab",{attrs:{"label-key":"elemental.machineRegistration.create.machineReg",name:"machine-reg","data-testid":"mach-reg-tab",weight:2}},[a("Banner",{staticClass:"mb-40",attrs:{color:"info","data-testid":"mach-reg-banner"}},[a("div",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("elemental.machineRegistration.create.labelsAndAnnotationsMachRegBanner",{},!0),expression:"t('elemental.machineRegistration.create.labelsAndAnnotationsMachRegBanner', {}, true)"}]})]),a("div",{staticClass:"row mb-30"},[a("KeyValue",{key:"labels",attrs:{"data-testid":"add-label-mach-reg",value:e.value.labels,"add-label":e.t("labels.addLabel"),mode:e.mode,title:e.t("labels.labels.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.value.setLabels(a)}}})],1),a("div",{staticClass:"row mb-10"},[a("KeyValue",{key:"annotations",attrs:{"data-testid":"add-annotation-mach-reg",value:e.value.annotations,"add-label":e.t("labels.addAnnotation"),mode:e.mode,title:e.t("labels.annotations.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.value.setAnnotations(a)}}})],1)],1)],1)],1)])]):a("Loading")},n=[],l=t("15ca"),i=t("fd5f"),o=t("305c"),r=t("6418"),c=t("870a"),d=t("8b2c"),u=t("a232"),m=t("3c8c"),h=t("7838"),v=t.n(h),p=t("c5e6"),g=t("da25"),b=t("3e9d"),f=t("0cb2"),C=t("38de"),y=t("193e"),O=t("7f49"),V={name:"MachineRegistrationEditView",components:{Loading:l["a"],CruResource:i["a"],YamlEditor:c["b"],KeyValue:u["a"],Banner:r["a"],FileSelector:d["a"],NameNsDescription:m["a"],Tabbed:f["a"],Tab:C["a"]},mixins:[o["a"]],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},resource:{type:String,required:!0}},async fetch(){if(this.mode===g["o"]){const e=await Object(y["i"])(this.$store);this.newCloudConfigcompatibilityCheck=Object(y["h"])(this.resource,this.mode,y["g"],e),this.value.spec||(this.value.spec=this.newCloudConfigcompatibilityCheck?O["DEFAULT_CREATION_YAML"]:O["OLD_DEFAULT_CREATION_YAML"]),this.cloudConfig="string"===typeof this.value.spec?this.value.spec:Object(p["d"])(this.value.spec),this.rerender=!0}},data(){return{rerender:!1,cloudConfig:"string"===typeof this.value.spec?this.value.spec:Object(p["d"])(this.value.spec),newCloudConfigcompatibilityCheck:!1,yamlErrors:null,isFormValid:!0}},watch:{cloudConfig:{handler(e){try{const a=v.a.load(e);this.value.spec=a,this.yamlErrors=null}catch(a){this.yamlErrors=Object(b["a"])(a)}},immediate:!0}},computed:{isCreate(){return this.mode===g["o"]},isView(){return this.mode!==g["o"]&&this.mode!==g["q"]},editorMode(){return this.isView?c["a"].VIEW_CODE:c["a"].EDIT_CODE},hasBeenCreated(){return!!this.value.id}},methods:{async save(e){this.errors=[];try{await this.value.save(),e(!0),this.isCreate?this.$router.replace(this.value.detailLocation):this.done()}catch(a){this.errors=Object(b["a"])(a),e(!1)}},updateLabels(e){this.value.setLabels(e,"machineInventoryLabels",!0);let a=!1,t=!1,s=!1,n=!1;this.errors=[],this.value.spec.machineInventoryLabels&&Object.keys(this.value.spec.machineInventoryLabels).length&&Object.keys(this.value.spec.machineInventoryLabels).forEach(e=>{if(e.includes("/")){const a=e.split("/")[0],n=e.split("/")[1];a.length>253&&(t=!0),n.length>63&&(s=!0)}else e.length>63&&(a=!0);this.value.spec.machineInventoryLabels[e].length>63&&(n=!0)}),n||a||t||s?(n&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelValueLength"))),a&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyLength"))),t&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyPrefixLength"))),s&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyNameLength")))):this.isFormValid=!0},onFileSelected(e){const a=this.$refs.yamleditor;a&&a.updateValue(e)}}},I=V,_=t("d802"),L=Object(_["a"])(I,s,n,!1,null,"66279357",null);a["default"]=L.exports},f09e:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e._self._c;return e.value?a("CruResource",{attrs:{"done-route":e.doneRoute,"can-yaml":!0,mode:e.mode,resource:e.value,errors:e.errors},on:{error:a=>e.errors=a,finish:e.save,cancel:e.done}},[a("div",{staticClass:"row mt-40 mb-20"},[a("div",{staticClass:"col span-12 mb-20"},[a("h3",[e._v(e._s(e.t("elemental.osimage.create.configuration")))]),a("NameNsDescription",{attrs:{mode:e.mode,"description-hidden":!0,namespaced:!1},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)]),e.value.spec?a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-6 mb-20"},[a("h3",[e._v(e._s(e.t("elemental.osimage.create.spec")))]),a("LabeledSelect",{staticClass:"mb-10",attrs:{"data-testid":"cluster-target",label:e.t("elemental.osimage.create.targetCluster.label"),placeholder:e.t("elemental.osimage.create.targetCluster.placeholder",null,!0),mode:e.mode,options:e.clusterTargetOptions,"option-key":"value",multiple:!0},on:{input:function(a){return e.handleClusterTargetChange(a)}},model:{value:e.clusterTargets,callback:function(a){e.clusterTargets=a},expression:"clusterTargets"}}),a("p",{directives:[{name:"clean-html",rawName:"v-clean-html",value:e.t("elemental.osimage.create.userWarning",{},!0),expression:"t('elemental.osimage.create.userWarning',{}, true)"}],staticClass:"user-warn mb-20"}),a("RadioGroup",{staticClass:"mb-20",attrs:{"data-testid":"upgrade-choice-selector",name:"os-image-mode",options:[!0,!1],labels:[e.t("elemental.osimage.create.radioOptions.osImages"),e.t("elemental.osimage.create.radioOptions.registry")],mode:e.mode},on:{input:function(a){return e.handleRadioBtnChange(a)}},model:{value:e.useManagedOsImages,callback:function(a){e.useManagedOsImages=a},expression:"useManagedOsImages"}}),e.useManagedOsImages?a("div",[a("LabeledSelect",{attrs:{"data-testid":"os-version-box",mode:e.mode,options:e.managedOSVersionOptions,"label-key":"elemental.osimage.create.managedOsImage.label",placeholder:e.t("elemental.osimage.create.managedOsImage.placeholder",null,!0),"option-key":"value"},on:{input:function(a){return e.handleManagedOSVersionNameChange(a)}},model:{value:e.osVersionSelected,callback:function(a){e.osVersionSelected=a},expression:"osVersionSelected"}})],1):a("div",[a("LabeledInput",{attrs:{"data-testid":"os-image-box",label:e.t("elemental.osimage.create.osImage.label"),placeholder:e.t("elemental.osimage.create.osImage.placeholder",null,!0),mode:e.mode},model:{value:e.value.spec.osImage,callback:function(a){e.$set(e.value.spec,"osImage","string"===typeof a?a.trim():a)},expression:"value.spec.osImage"}})],1)],1)]):e._e()]):a("Loading")},n=[],l=t("15ca"),i=t("fd5f"),o=t("305c"),r=t("8e93"),c=t("466b"),d=t("3c8c"),u=t("e143"),m=t("a8b9"),h=t("da25"),v=t("907c"),p=t("c41f"),g=t("a655"),b={name:"ManagedOsImagesEditView",components:{Loading:l["a"],LabeledInput:r["a"],LabeledSelect:c["a"],CruResource:i["a"],NameNsDescription:d["a"],RadioGroup:u["a"]},mixins:[o["a"]],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){const e={};e.rancherClusters=this.$store.dispatch("management/findAll",{type:v["a"].RANCHER_CLUSTER}),e.osGroups=this.$store.dispatch("management/findAll",{type:p["e"].MANAGED_OS_IMAGES}),e.osVersions=this.$store.dispatch("management/findAll",{type:p["e"].MANAGED_OS_VERSIONS}),e.osVersionChannels=this.$store.dispatch("management/findAll",{type:p["e"].MANAGED_OS_VERSION_CHANNELS});const a=await Object(m["a"])(e);if(this.elementalClusters=Object(g["a"])(a.rancherClusters||[]),this.osGroups=a.osGroups||[],this.osVersions=a.osVersions||[],this.osVersionChannels=a.osVersionChannels||[],this.mode===h["q"]||this.mode===h["x"]){var t,s,n;if(null!==(t=this.value)&&void 0!==t&&null!==(t=t.spec)&&void 0!==t&&t.managedOSVersionName)this.osVersionSelected=null===(n=this.value)||void 0===n||null===(n=n.spec)||void 0===n?void 0:n.managedOSVersionName,this.useManagedOsImages=!0;else this.useManagedOsImages=!1;if(null!==(s=this.value)&&void 0!==s&&null!==(s=s.spec)&&void 0!==s&&null!==(s=s.clusterTargets)&&void 0!==s&&s.length){var l;const e=[];null===(l=this.value)||void 0===l||null===(l=l.spec)||void 0===l||l.clusterTargets.forEach(a=>{e.push(a.clusterName)}),this.clusterTargets=e}}const i=Object(g["b"])(this.elementalClusters,this.osGroups,this.value.id);this.clusterTargetOptions=i.map(e=>({label:e.name,value:e.name}))},data(){return{elementalClusters:[],osGroups:[],osVersions:[],osVersionChannels:[],clusterTargets:[],clusterTargetOptions:[],useManagedOsImages:!0,osVersionSelected:""}},computed:{managedOSVersionOptions(){const e=[];return this.osVersionChannels.forEach(a=>{const t=this.osVersions.filter(e=>{var t,s,n,l;const i=null===(t=e.metadata)||void 0===t?void 0:t.ownerReferences.find(e=>{var t,s;return e.name===a.name&&(null===(t=this.value)||void 0===t||null===(t=t.metadata)||void 0===t?void 0:t.namespace)===(null===(s=a.metadata)||void 0===s?void 0:s.namespace)});return i&&Object.keys(i).length&&(null===(s=this.value)||void 0===s||null===(s=s.metadata)||void 0===s?void 0:s.namespace)===(null===(n=e.metadata)||void 0===n?void 0:n.namespace)&&"container"===(null===(l=e.spec)||void 0===l?void 0:l.type)});t.length&&(e.push({kind:"group",label:this.t("elemental.osimage.create.managedOsImage.channel",{name:a.name}),value:this.t("elemental.osimage.create.managedOsImage.channel",{name:a.name})}),t.forEach(a=>{e.push({label:a.name,value:a.name})}))}),e},isCreate(){return this.mode===h["o"]}},methods:{handleClusterTargetChange(e){this.value.spec.clusterTargets=e.map(e=>({clusterName:e})),this.clusterTargets=e},handleManagedOSVersionNameChange(e){this.value.spec.managedOSVersionName=e,this.osVersionSelected=e},handleRadioBtnChange(e){var a,t;e?null===(a=this.value)||void 0===a||null===(a=a.spec)||void 0===a||delete a.osImage:(null===(t=this.value)||void 0===t||null===(t=t.spec)||void 0===t||delete t.managedOSVersionName,this.osVersionSelected="");this.useManagedOsImages=e}}},f=b,C=(t("429d"),t("d802")),y=Object(C["a"])(f,s,n,!1,null,"30d4118f",null);a["default"]=y.exports}}]);
//# sourceMappingURL=elemental-2.0.2.umd.min.edit.js.map