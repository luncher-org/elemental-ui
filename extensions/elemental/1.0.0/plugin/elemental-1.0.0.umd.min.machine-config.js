(("undefined"!==typeof self?self:this)["webpackJsonpelemental_1_0_0"]=("undefined"!==typeof self?self:this)["webpackJsonpelemental_1_0_0"]||[]).push([[12,4],{"0461":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",{directives:[{name:"t",rawName:"v-t",value:"elemental.clusterGroup.selector.label",expression:"'elemental.clusterGroup.selector.label'"}],staticClass:"mt-20 mb-20"}),s("MatchExpressions",{attrs:{mode:e.mode,value:e.expressions,"show-remove":!1,"keys-select-options":e.machineInventorySelectorKeyOptions},on:{input:function(t){return e.matchChanged(t)}}}),e.matchingMachineInventories?s("Banner",{attrs:{color:e.matchingMachineInventories.isNone||e.matchingMachineInventories.isAll?"warning":"success"}},[e.matchingMachineInventories.isAll?s("span",{domProps:{innerHTML:e._s(e.t("elemental.clusterGroup.selector.matchesAll",e.matchingMachineInventories))}}):e.matchingMachineInventories.isNone?s("span",{domProps:{innerHTML:e._s(e.t("elemental.clusterGroup.selector.matchesNone",e.matchingMachineInventories))}}):s("span",{domProps:{innerHTML:e._s(e.t("elemental.clusterGroup.selector.matchesSome",e.matchingMachineInventories))}})]):e._e()],1)},a=[],l=s("711b"),i=s("305c"),r=s("6418"),c=s("e24b"),o=s("2879"),h=s("05ca"),u=s.n(h),p=s("c41f"),d={components:{MatchExpressions:l["a"],Banner:r["a"]},mixins:[i["a"]],async fetch(){this.machineInventories=await this.$store.dispatch("management/findAll",{type:p["c"].MACHINE_INVENTORIES}),this.machineInventorySelectorKeyOptions=this.getUniqueLabels(this.machineInventories).map(e=>({label:e,value:e})),this.updateMatchingMachineInventories()},data(){var e,t,s;null!==(e=this.value.spec)&&void 0!==e&&null!==(t=e.template)&&void 0!==t&&null!==(s=t.spec)&&void 0!==s&&s.selector||(this.value.spec.template.spec=this.value.spec.template.spec||{},this.value.spec.template.spec.selector={matchExpressions:[],matchLabels:{}});const n=this.$store.getters["elemental/createClusterElements"];var a,l,i,r;n.length&&(this.value.spec.template.spec.selector.matchExpressions.push({key:"create-cluster-selector",operator:"In",values:[n[0].metadata.labels["create-cluster-selector"]]}),null!==(a=this.value.spec)&&void 0!==a&&null!==(l=a.template)&&void 0!==l&&null!==(i=l.spec)&&void 0!==i&&null!==(r=i.selector)&&void 0!==r&&r.matchLabels||(this.value.spec.template.spec.selector.matchLabels={}),this.value.spec.template.spec.selector.matchLabels["create-cluster-selector"]=n[0].metadata.labels["create-cluster-selector"],this.$store.dispatch("elemental/updateCreateClusterElements",[]));const c=Object(o["a"])(this.value.spec.template.spec.selector.matchLabels||{},this.value.spec.template.spec.selector.matchExpressions||[]);return{machineInventories:null,matchingMachineInventories:null,machineInventorySelectorKeyOptions:null,expressions:c}},methods:{set:c["set"],getUniqueLabels(e){const t=[];return e.forEach(e=>{var s,n;if(null!==(s=e.metadata)&&void 0!==s&&s.labels&&Object.keys(null===(n=e.metadata)||void 0===n?void 0:n.labels).length){var a;const s=Object.keys(null===(a=e.metadata)||void 0===a?void 0:a.labels);s.forEach(e=>{t.includes(e)||t.push(e)})}}),t},matchChanged(e){const{matchLabels:t,matchExpressions:s}=Object(o["d"])(e);Object(c["set"])(this,"expressions",e),Object(c["set"])(this,"value.spec.template.spec.selector.matchLabels",t),Object(c["set"])(this,"value.spec.template.spec.selector.matchExpressions",s),this.updateMatchingMachineInventories()},updateMatchingMachineInventories:u()((function(){var e;const t=this.machineInventories,s=Object(o["c"])(t,this.expressions),n=s.length||0,a=null===(e=s[0])||void 0===e?void 0:e.nameDisplay;this.matchingMachineInventories={matched:n,total:t.length,isAll:n===t.length,isNone:0===n,sample:a},this.$emit("updateMachineCount",n)}),250,{leading:!0})}},m=d,v=s("d802"),g=Object(v["a"])(m,n,a,!1,null,null,null);t["default"]=g.exports},"13ed":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.$fetchState.pending?s("Loading",{attrs:{delayed:!0}}):e.errors.length?s("div",e._l(e.errors,(function(t,n){return s("div",{key:n},[s("Banner",{attrs:{color:"error",label:e.stringify(t)}})],1)})),0):s("div",[s("Questions",{attrs:{mode:e.mode,tabbed:!1,source:e.fields,"ignore-variables":e.cloudCredentialKeys,"target-namespace":e.value.metadata.namespace,disabled:e.disabled},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)},a=[],l=s("15ca"),i=s("6418"),r=s("305c"),c=s("3e9d"),o=s("a943"),h={components:{Loading:l["a"],Banner:i["a"],Questions:o["a"]},mixins:[r["a"]],props:{credentialId:{type:String,required:!0},provider:{type:String,required:!0},disabled:{type:Boolean,default:!1}},fetch(){this.errors=[];try{this.fields=this.$store.getters["plugins/fieldsForDriver"](this.provider);const e=`rke-machine-config.cattle.io.${this.provider}config`;if(!this.fields)throw new Error("Machine Driver config schema not found for "+e)}catch(e){this.errors=Object(c["c"])(e)}},data(){return{errors:null,fields:null}},computed:{cloudCredentialKeys(){const e=this.$store.getters["plugins/credentialFieldForDriver"](this.provider),t=this.$store.getters["rancher/schemaFor"](e+"credentialconfig");return t?Object.keys(t.resourceFields||{}):this.$store.getters["plugins/fieldNamesForDriver"](this.provider)}},watch:{credentialId(){this.$fetch()}},methods:{stringify:c["d"]}},u=h,p=s("d802"),d=Object(p["a"])(u,n,a,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=elemental-1.0.0.umd.min.machine-config.js.map