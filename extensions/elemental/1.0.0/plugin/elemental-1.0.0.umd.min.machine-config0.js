(("undefined"!==typeof self?self:this)["webpackJsonpelemental_1_0_0"]=("undefined"!==typeof self?self:this)["webpackJsonpelemental_1_0_0"]||[]).push([[0],{"04d1":function(e,t,a){var s=a("1ec1");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var l=a("0ed3").default;l("5048ecf6",s,!0,{sourceMap:!1,shadowMode:!1})},"1ec1":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,'.clearfix[data-v-0f3ebcc0]:after,.clearfix[data-v-0f3ebcc0]:before{content:" ";display:table}.clearfix[data-v-0f3ebcc0]:after{clear:both}.list-unstyled[data-v-0f3ebcc0]{margin:0;padding:0;list-style-type:none}.no-select[data-v-0f3ebcc0]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.no-resize[data-v-0f3ebcc0]{resize:none}.hand[data-v-0f3ebcc0]{cursor:pointer;cursor:hand}.fixed[data-v-0f3ebcc0]{table-layout:fixed}.clip[data-v-0f3ebcc0]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.clip[data-v-0f3ebcc0],.force-wrap[data-v-0f3ebcc0]{word-wrap:break-word}.force-wrap[data-v-0f3ebcc0]{white-space:normal}.bordered-section[data-v-0f3ebcc0]{border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:20px}.section-divider[data-v-0f3ebcc0]{margin-bottom:20px;margin-top:20px}.vpc[data-v-0f3ebcc0],.vpc-subnet[data-v-0f3ebcc0]{display:flex;line-height:30px}.vpc-subnet .vpc-name[data-v-0f3ebcc0],.vpc .vpc-name[data-v-0f3ebcc0]{font-weight:700;flex:1}.vpc-subnet .vpc-info[data-v-0f3ebcc0],.vpc .vpc-info[data-v-0f3ebcc0]{font-size:12px;opacity:.7}.vpc-subnet .vpc-name[data-v-0f3ebcc0]{font-weight:400;padding-left:15px}',""]),e.exports=t},"8df0":function(e,t,a){"use strict";a("04d1")},eff5:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.$fetchState.pending?a("Loading"):[e.errors.length?a("div",e._l(e.errors,(function(t,s){return a("div",{key:s},[a("Banner",{attrs:{color:"error",label:e.stringify(t)}})],1)})),0):e._e(),e.loadedRegionalFor?a("div",[a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-6"},[a("LabeledSelect",{attrs:{mode:e.mode,options:e.regionOptions,required:!0,searchable:!0,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.region")},model:{value:e.value.region,callback:function(t){e.$set(e.value,"region",t)},expression:"value.region"}})],1),a("div",{staticClass:"col span-6"},[a("LabeledSelect",{attrs:{mode:e.mode,options:e.zoneOptions,required:!0,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.zone")},model:{value:e.value.zone,callback:function(t){e.$set(e.value,"zone",t)},expression:"value.zone"}})],1)]),a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col span-9"},[a("LabeledSelect",{attrs:{mode:e.mode,options:e.instanceOptions,required:!0,selectable:function(e){return!e.disabled},searchable:!0,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.instanceType")},scopedSlots:e._u([{key:"option",fn:function(t){return["group"===t.kind?[a("b",[e._v(e._s(t.label))])]:[a("span",{staticClass:"pl-10"},[e._v(e._s(t.label))])]]}}],null,!1,397254338),model:{value:e.value.instanceType,callback:function(t){e.$set(e.value,"instanceType",t)},expression:"value.instanceType"}})],1),a("div",{staticClass:"col span-3"},[a("UnitInput",{attrs:{"output-as":"string",mode:e.mode,disabled:e.disabled,placeholder:e.t("cluster.machineConfig.amazonEc2.rootSize.placeholder"),label:e.t("cluster.machineConfig.amazonEc2.rootSize.label"),suffix:e.t("cluster.machineConfig.amazonEc2.rootSize.suffix")},model:{value:e.value.rootSize,callback:function(t){e.$set(e.value,"rootSize",t)},expression:"value.rootSize"}})],1)]),a("div",{staticClass:"row mt-20 mb-20"},[a("div",{staticClass:"col span-6"},[a("LabeledSelect",{attrs:{mode:e.mode,value:e.selectedNetwork,options:e.networkOptions,searchable:!0,required:!0,disabled:e.disabled,placeholder:e.t("cluster.machineConfig.amazonEc2.selectedNetwork.placeholder"),label:e.t("cluster.machineConfig.amazonEc2.selectedNetwork.label"),"option-key":"value"},on:{input:function(t){return e.updateNetwork(t)}},scopedSlots:e._u([{key:"option",fn:function(t){return[a("div",{class:{vpc:"vpc"===t.kind,"vpc-subnet":"vpc"!==t.kind}},[a("span",{staticClass:"vpc-name"},[e._v(e._s(t.label))]),a("span",{staticClass:"vpc-info"},[e._v(e._s(t.subLabel))])])]}}],null,!1,831602914)})],1),a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{mode:e.mode,disabled:e.disabled,required:e.isIamInstanceProfileNameRequired,tooltip:e.t("cluster.machineConfig.amazonEc2.iamInstanceProfile.tooltip"),label:e.t("cluster.machineConfig.amazonEc2.iamInstanceProfile.label")},model:{value:e.value.iamInstanceProfile,callback:function(t){e.$set(e.value,"iamInstanceProfile",t)},expression:"value.iamInstanceProfile"}})],1)]),a("portal",{attrs:{to:"advanced-"+e.uuid}},[a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{mode:e.mode,disabled:e.disabled,placeholder:e.t("cluster.machineConfig.amazonEc2.ami.placeholder"),label:e.t("cluster.machineConfig.amazonEc2.ami.label")},model:{value:e.value.ami,callback:function(t){e.$set(e.value,"ami",t)},expression:"value.ami"}})],1),a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{mode:e.mode,label:e.t("cluster.machineConfig.amazonEc2.sshUser.label"),disabled:!e.value.ami||e.disabled,tooltip:e.t("cluster.machineConfig.amazonEc2.sshUser.tooltip"),placeholder:e.t("cluster.machineConfig.amazonEc2.sshUser.placeholder")},model:{value:e.value.sshUser,callback:function(t){e.$set(e.value,"sshUser",t)},expression:"value.sshUser"}})],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-12"},[a("h3",[e._v(" "+e._s(e.t("cluster.machineConfig.amazonEc2.securityGroup.title"))+" "),e.value.vpcId?e._e():a("span",{staticClass:"text-muted text-small"},[e._v(" "+e._s(e.t("cluster.machineConfig.amazonEc2.securityGroup.vpcId"))+" ")])]),a("RadioGroup",{attrs:{name:"securityGroupMode",mode:e.mode,disabled:!e.value.vpcId||e.disabled,labels:e.securityGroupLabels,options:["default","custom"]},model:{value:e.securityGroupMode,callback:function(t){e.securityGroupMode=t},expression:"securityGroupMode"}}),e.value.vpcId&&"custom"===e.securityGroupMode?a("LabeledSelect",{attrs:{mode:e.mode,disabled:!e.value.vpcId||e.disabled,options:e.securityGroupOptions,searchable:!0,multiple:!0,taggable:!0},model:{value:e.value.securityGroup,callback:function(t){e.$set(e.value,"securityGroup",t)},expression:"value.securityGroup"}}):e._e()],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("LabeledInput",{attrs:{mode:e.mode,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.volumeType.label"),placeholder:e.t("cluster.machineConfig.amazonEc2.volumeType.placeholder")},model:{value:e.value.volumeType,callback:function(t){e.$set(e.value,"volumeType",t)},expression:"value.volumeType"}})],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-12"},[a("Checkbox",{attrs:{mode:e.mode,label:e.t("cluster.machineConfig.amazonEc2.encryptEbsVolume")},model:{value:e.value.encryptEbsVolume,callback:function(t){e.$set(e.value,"encryptEbsVolume",t)},expression:"value.encryptEbsVolume"}}),e.value.encryptEbsVolume?a("div",{staticClass:"mt-10"},[e.canReadKms?a("LabeledSelect",{attrs:{mode:e.mode,options:e.kmsOptions,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.kmsKey.label")},model:{value:e.value.kmsKey,callback:function(t){e.$set(e.value,"kmsKey",t)},expression:"value.kmsKey"}}):[a("LabeledInput",{attrs:{mode:e.mode,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.kmsKey.label")},model:{value:e.value.kmsKey,callback:function(t){e.$set(e.value,"kmsKey",t)},expression:"value.kmsKey"}}),a("p",{staticClass:"text-muted"},[e._v(" "+e._s(e.t("cluster.machineConfig.amazonEc2.kmsKey.text"))+" ")])]],2):e._e()],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-6"},[a("Checkbox",{attrs:{mode:e.mode,label:e.t("cluster.machineConfig.amazonEc2.requestSpotInstance")},model:{value:e.value.requestSpotInstance,callback:function(t){e.$set(e.value,"requestSpotInstance",t)},expression:"value.requestSpotInstance"}}),e.value.requestSpotInstance?a("div",{staticClass:"mt-10"},[a("UnitInput",{attrs:{"output-as":"string",mode:e.mode,disabled:e.disabled,placeholder:e.t("cluster.machineConfig.amazonEc2.spotPrice.placeholder"),label:e.t("cluster.machineConfig.amazonEc2.spotPrice.label"),suffix:e.t("cluster.machineConfig.amazonEc2.spotPrice.suffix")},model:{value:e.value.spotPrice,callback:function(t){e.$set(e.value,"spotPrice",t)},expression:"value.spotPrice"}})],1):e._e()],1)]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-12"},[a("div",[a("Checkbox",{attrs:{mode:e.mode,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.privateAddressOnly")},model:{value:e.value.privateAddressOnly,callback:function(t){e.$set(e.value,"privateAddressOnly",t)},expression:"value.privateAddressOnly"}})],1),a("div",[a("Checkbox",{attrs:{mode:e.mode,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.useEbsOptimizedInstance")},model:{value:e.value.useEbsOptimizedInstance,callback:function(t){e.$set(e.value,"useEbsOptimizedInstance",t)},expression:"value.useEbsOptimizedInstance"}})],1),a("div",[a("Checkbox",{attrs:{"value-when-true":"enabled",mode:e.mode,disabled:e.disabled,label:e.t("cluster.machineConfig.amazonEc2.httpEndpoint")},model:{value:e.value.httpEndpoint,callback:function(t){e.$set(e.value,"httpEndpoint",t)},expression:"value.httpEndpoint"}})],1),a("div",[a("Checkbox",{attrs:{"value-when-true":"required",mode:e.mode,disabled:!e.value.httpEndpoint||e.disabled,label:e.t("cluster.machineConfig.amazonEc2.httpTokens")},model:{value:e.value.httpTokens,callback:function(t){e.$set(e.value,"httpTokens",t)},expression:"value.httpTokens"}})],1)])]),a("div",{staticClass:"row mt-20"},[a("div",{staticClass:"col span-12"},[a("KeyValue",{attrs:{value:e.tags,mode:e.mode,"read-allowed":!1,label:e.t("cluster.machineConfig.amazonEc2.tagTitle"),"add-label":e.t("labels.addTag"),disabled:e.disabled},on:{input:e.updateTags}})],1)])])],1):e._e()]],2)},l=[],i=a("15ca"),n=a("6418"),o=a("305c"),c=a("466b"),d=a("8e93"),r=a("a232"),u=a("4978"),p=a("e143"),v=a("0df0"),m=a("907c"),b=a("a8b9"),h=a("bddd"),f=a("1d19"),g=a("3e9d");const y="rancher-nodes";var I={components:{Banner:n["a"],Loading:i["a"],LabeledInput:d["a"],LabeledSelect:c["a"],Checkbox:v["a"],RadioGroup:p["a"],UnitInput:u["a"],KeyValue:r["a"]},mixins:[o["a"]],props:{uuid:{type:String,required:!0},cluster:{type:Object,default:()=>({})},credentialId:{type:String,required:!0},disabled:{type:Boolean,default:!1}},async fetch(){if(this.errors=[],this.credentialId){try{var e;(null===(e=this.credential)||void 0===e?void 0:e.id)!==this.credentialId&&(this.credential=await this.$store.dispatch("rancher/find",{type:m["u"].CLOUD_CREDENTIAL,id:this.credentialId}))}catch(l){this.credential=null}try{var t,a,s;const e=this.value.region||(null===(t=this.credential)||void 0===t?void 0:t.decodedData.defaultRegion)||this.$store.getters["aws/defaultRegion"];this.value.region||this.$set(this.value,"region",e),this.ec2Client=await this.$store.dispatch("aws/ec2",{region:e,cloudCredentialId:this.credentialId}),this.kmsClient=await this.$store.dispatch("aws/kms",{region:e,cloudCredentialId:this.credentialId}),this.instanceInfo||(this.instanceInfo=await this.$store.dispatch("aws/instanceInfo",{client:this.ec2Client}));const i={};this.regionInfo||(i.regionInfo=this.ec2Client.describeRegions({})),this.loadedRegionalFor!==e&&(i.zoneInfo=await this.ec2Client.describeAvailabilityZones({}),i.vpcInfo=await this.ec2Client.describeVpcs({}),i.subnetInfo=await this.ec2Client.describeSubnets({}),i.securityGroupInfo=await this.ec2Client.describeSecurityGroups({}));const n=await Object(b["a"])(i);for(const t in n)this[t]=n[t];try{this.kmsInfo=await this.kmsClient.listKeys({}),this.canReadKms=!0}catch(l){this.canReadKms=!1}this.value.zone||this.$set(this.value,"zone","a"),this.value.instanceType||this.$set(this.value,"instanceType",this.$store.getters["aws/defaultInstanceType"]),this.initNetwork(),this.initTags(),null!==(a=this.value.securityGroup)&&void 0!==a&&a.length||this.$set(this.value,"securityGroup",[y]),1===(null===(s=this.value.securityGroup)||void 0===s?void 0:s.length)&&this.value.securityGroup[0]===y?this.securityGroupMode="default":this.securityGroupMode="custom",this.loadedRegionalFor=e}catch(l){this.errors=Object(g["c"])(l)}}},data(){return{ec2Client:null,kmsClient:null,credential:null,instanceInfo:null,regionInfo:null,canReadKms:null,kmsInfo:null,tags:null,loadedRegionalFor:null,zoneInfo:null,vpcInfo:null,subnetInfo:null,securityGroupInfo:null,selectedNetwork:null,securityGroupMode:null}},computed:{securityGroupLabels(){return[this.t("cluster.machineConfig.amazonEc2.securityGroup.mode.default",{defaultGroup:y}),this.t("cluster.machineConfig.amazonEc2.securityGroup.mode.custom")]},isIamInstanceProfileNameRequired(){var e;return"aws"===(null===(e=this.cluster)||void 0===e?void 0:e.cloudProvider)},instanceOptions(){let e;const t=[];for(const a of this.instanceInfo)a.groupLabel!==e&&(t.push({kind:"group",disabled:!0,label:a.groupLabel}),e=a.groupLabel),t.push({label:a["label"],value:a["apiName"]});return t},regionOptions(){return this.regionInfo?this.regionInfo.Regions.map(e=>e.RegionName).sort():[]},zoneOptions(){return this.zoneInfo?this.zoneInfo.AvailabilityZones.map(e=>e.ZoneName.substr(-1)).sort():[]},networkOptions(){if(!this.vpcInfo||!this.subnetInfo)return[];let e=[];const t={};for(const o of this.vpcInfo.Vpcs){var a,s;const t=o.Tags&&null!==(a=o.Tags)&&void 0!==a&&a.length?null===(s=o.Tags.find(e=>"Name"===e.Key))||void 0===s?void 0:s.Value:null;e.push({label:t||o.VpcId,subLabel:t?o.VpcId:o.CidrBlock,isDefault:o.IsDefault||!1,kind:"vpc",value:o.VpcId})}e=Object(f["a"])(e,["isDefault:desc","label"]);for(const o of this.subnetInfo.Subnets){var l,i;if(o.AvailabilityZone!==`${this.value.region}${this.value.zone}`)continue;let e=t[o.VpcId];e||(e=[],t[o.VpcId]=e);const a=o.Tags&&null!==(l=o.Tags)&&void 0!==l&&l.length?null===(i=o.Tags.find(e=>"Name"===e.Key))||void 0===i?void 0:i.Value:null;e.push({label:a||o.SubnetId,subLabel:a?o.SubnetId:o.CidrBlock,kind:"subnet",isDefault:o.DefaultForAz||!1,value:o.SubnetId,vpcId:o.VpcId})}const n=[];for(const o of e)Object(h["a"])(n,o),t[o.value]&&Object(h["b"])(n,Object(f["a"])(t[o.value],["isDefault:desc","label"]));return n},securityGroupOptions(){if(!this.securityGroupInfo)return[];const e=this.securityGroupInfo.SecurityGroups.filter(e=>e.VpcId===this.value.vpcId).map(e=>({label:e.GroupName,description:e.GroupDescription,value:e.GroupName}));return Object(f["a"])(e,"label")},kmsOptions(){if(!this.kmsInfo)return[];const e=this.kmsInfo.Keys.map(e=>e.KeyArn).sort();return e},DEFAULT_GROUP(){return y}},watch:{credentialId(){this.$fetch()},"value.region"(){this.$fetch()},"value.zone"(){this.$fetch()},securityGroupMode(e){this.value.securityGroupReadonly="default"!==e}},methods:{stringify:g["d"],initNetwork(){const e=this.value.subnetId||this.value.vpcId;this.selectedNetwork=e},updateNetwork(e){var t;let a;e&&(a=Object(h["e"])(this.networkOptions,"value",e)),"subnet"===(null===(t=a)||void 0===t?void 0:t.kind)?(this.value.subnetId=e,this.value.vpcId=a.vpcId,this.selectedNetwork=e):a?(this.value.subnetId=null,this.value.vpcId=e,this.selectedNetwork=e):(this.value.subnetId=null,this.value.vpcId=null,this.selectedNetwork=null)},initTags(){const e=(this.value.tags||"").split(/,/),t={};let a=0;while(a+1<e.length){const s=(""+e[a]).trim(),l=(""+e[a+1]).trim();s&&(t[s]=l),a+=2}this.tags=t},updateTags(e){const t=[];for(const a in e)t.push(a,e[a]);this.$set(this.value,"tags",t.join(","))},test(){const e=[];return this.selectedNetwork||e.push(this.t("validation.required",{key:"VPC/Subnet"},!0)),{errors:e}}}},C=I,k=(a("8df0"),a("d802")),w=Object(k["a"])(C,s,l,!1,null,"0f3ebcc0",null);t["default"]=w.exports}}]);
//# sourceMappingURL=elemental-1.0.0.umd.min.machine-config0.js.map