(("undefined"!==typeof self?self:this)["webpackJsonpelemental_1_1_0"]=("undefined"!==typeof self?self:this)["webpackJsonpelemental_1_1_0"]||[]).push([[2],{"0f86":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return e.value?t("CruResource",{attrs:{"done-route":e.doneRoute,"can-yaml":!0,mode:e.mode,resource:e.value,errors:e.errors},on:{error:function(a){return e.errors=a},finish:e.save,cancel:e.done}},[t("div",{staticClass:"row mt-40 mb-20"},[t("div",{staticClass:"col span-12 mb-20"},[t("h3",[e._v(e._s(e.t("elemental.osversionchannels.create.configuration")))]),t("NameNsDescription",{attrs:{mode:e.mode,"description-hidden":!0,namespaced:!1},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)]),e.value.spec?t("div",{staticClass:"row mb-20"},[t("div",{staticClass:"col span-6 mb-20"},[t("h3",[e._v(e._s(e.t("elemental.osversionchannels.create.spec")))]),t("LabeledInput",{attrs:{"data-testid":"os-version-channel-path",label:e.t("elemental.osversionchannels.create.registryUri.label"),placeholder:e.t("elemental.osversionchannels.create.registryUri.placeholder",null,!0),mode:e.mode},model:{value:e.value.spec.options.image,callback:function(a){e.$set(e.value.spec.options,"image","string"===typeof a?a.trim():a)},expression:"value.spec.options.image"}})],1)]):e._e()]):t("Loading")},n=[],l=t("15ca"),i=t("fd5f"),o=t("305c"),r=t("8e93"),c=t("3c8c"),d={name:"ManagedOsVersionChannelEditView",components:{Loading:l["a"],LabeledInput:r["a"],CruResource:i["a"],NameNsDescription:c["a"]},mixins:[o["a"]],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}}},m=d,u=t("d802"),h=Object(u["a"])(m,s,n,!1,null,null,null);a["default"]=h.exports},a6ba:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return e.value?t("CruResource",{attrs:{"done-route":e.doneRoute,"can-yaml":!0,mode:e.mode,resource:e.value,errors:e.errors,"validation-passed":e.isFormValid},on:{error:function(a){return e.errors=a},finish:e.save,cancel:e.done}},[t("div",{staticClass:"row mb-40",class:{"mt-40":!e.hasBeenCreated}},[t("div",{staticClass:"col span-12"},[t("h3",[e._v(e._s(e.t("elemental.machineRegistration.create.configuration")))]),t("NameNsDescription",{attrs:{mode:e.mode,"description-hidden":!0,namespaced:!1},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)]),t("div",{staticClass:"row mb-20"},[t("div",{staticClass:"col span-6"},[t("h3",[e._v(e._s(e.t("elemental.machineRegistration.create.cloudConfiguration")))]),t("YamlEditor",{ref:"yamleditor",staticClass:"mb-20",attrs:{"editor-mode":e.editorMode},model:{value:e.cloudConfig,callback:function(a){e.cloudConfig=a},expression:"cloudConfig"}}),e.isView?e._e():t("div",{staticClass:"mb-20"},[t("FileSelector",{staticClass:"btn role-secondary",attrs:{"data-testid":"read-from-file-btn",label:e.t("elemental.machineRegistration.create.readFromFile")},on:{selected:e.onFileSelected}})],1),e._l(e.yamlErrors,(function(e,a){return t("Banner",{key:a,attrs:{color:"error",label:e}})}))],2)]),t("div",{staticClass:"row mb-40"},[t("div",{staticClass:"col span-12"},[t("h3",{staticClass:"mt-10"},[e._v(" "+e._s(e.t("elemental.machineRegistration.create.labelsAndAnnotations"))+" ")]),t("Tabbed",{attrs:{"data-testid":"labels-and-annotations-block"}},[t("Tab",{attrs:{"label-key":"elemental.machineRegistration.create.machineInv",name:"machine-inventory","data-testid":"mach-inv-tab",weight:3}},[t("Banner",{staticClass:"mb-40",attrs:{color:"info","data-testid":"mach-inv-banner"},domProps:{innerHTML:e._s(e.t("elemental.machineRegistration.create.labelsAndAnnotationsMachInvBanner",{},!0))}}),t("div",{staticClass:"row mb-30"},[t("KeyValue",{key:"labels",attrs:{"data-testid":"add-label-mach-inv",value:e.value.machineInventoryLabels,"add-label":e.t("labels.addLabel"),mode:e.mode,title:e.t("labels.labels.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.updateLabels(a)}}})],1),t("div",{staticClass:"row mb-10"},[t("KeyValue",{key:"annotations",attrs:{"data-testid":"add-annotation-mach-inv",value:e.value.machineInventoryAnnotations,"add-label":e.t("labels.addAnnotation"),mode:e.mode,title:e.t("labels.annotations.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.value.setAnnotations(a,"machineInventoryAnnotations",!0)}}})],1)],1),t("Tab",{attrs:{"label-key":"elemental.machineRegistration.create.machineReg",name:"machine-reg","data-testid":"mach-reg-tab",weight:2}},[t("Banner",{staticClass:"mb-40",attrs:{color:"info","data-testid":"mach-reg-banner"},domProps:{innerHTML:e._s(e.t("elemental.machineRegistration.create.labelsAndAnnotationsMachRegBanner",{},!0))}}),t("div",{staticClass:"row mb-30"},[t("KeyValue",{key:"labels",attrs:{"data-testid":"add-label-mach-reg",value:e.value.labels,"add-label":e.t("labels.addLabel"),mode:e.mode,title:e.t("labels.labels.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.value.setLabels(a)}}})],1),t("div",{staticClass:"row mb-10"},[t("KeyValue",{key:"annotations",attrs:{"data-testid":"add-annotation-mach-reg",value:e.value.annotations,"add-label":e.t("labels.addAnnotation"),mode:e.mode,title:e.t("labels.annotations.title"),"read-allowed":!1,"value-can-be-empty":!0},on:{input:function(a){return e.value.setAnnotations(a)}}})],1)],1)],1)],1)])]):t("Loading")},n=[],l=t("15ca"),i=t("fd5f"),o=t("305c"),r=t("6418"),c=t("870a"),d=t("8b2c"),m=t("a232"),u=t("3c8c"),h=t("7838"),v=t.n(h),p=t("c5e6"),b=t("da25"),g=t("3e9d"),f=t("0cb2"),y=t("38de"),C={name:"MachineRegistrationEditView",components:{Loading:l["a"],CruResource:i["a"],YamlEditor:c["b"],KeyValue:m["a"],Banner:r["a"],FileSelector:d["a"],NameNsDescription:u["a"],Tabbed:f["a"],Tab:y["a"]},mixins:[o["a"]],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},data(){return{cloudConfig:"string"===typeof this.value.spec?this.value.spec:Object(p["b"])(this.value.spec),yamlErrors:null,isFormValid:!0}},watch:{cloudConfig:{handler(e){try{const a=v.a.load(e);this.value.spec=a,this.yamlErrors=null}catch(a){this.yamlErrors=Object(g["b"])(a)}},immediate:!0}},computed:{isCreate(){return this.mode===b["j"]},isView(){return this.mode!==b["j"]&&this.mode!==b["l"]},editorMode(){return this.isView?c["a"].VIEW_CODE:c["a"].EDIT_CODE},hasBeenCreated(){return!!this.value.id}},methods:{async save(e){this.errors=[];try{await this.value.save(),e(!0),this.isCreate?this.$router.replace(this.value.detailLocation):this.done()}catch(a){this.errors=Object(g["b"])(a),e(!1)}},updateLabels(e){this.value.setLabels(e,"machineInventoryLabels",!0);let a=!1,t=!1,s=!1,n=!1;this.errors=[],this.value.spec.machineInventoryLabels&&Object.keys(this.value.spec.machineInventoryLabels).length&&Object.keys(this.value.spec.machineInventoryLabels).forEach(e=>{if(e.includes("/")){const a=e.split("/")[0],n=e.split("/")[1];a.length>253&&(t=!0),n.length>63&&(s=!0)}else e.length>63&&(a=!0);this.value.spec.machineInventoryLabels[e].length>63&&(n=!0)}),n||a||t||s?(n&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelValueLength"))),a&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyLength"))),t&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyPrefixLength"))),s&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyNameLength")))):this.isFormValid=!0},onFileSelected(e){const a=this.$refs.yamleditor;a&&a.updateValue(e)}}},O=C,V=t("d802"),_=Object(V["a"])(O,s,n,!1,null,"181bd290",null);a["default"]=_.exports},f09e:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return e.value?t("CruResource",{attrs:{"done-route":e.doneRoute,"can-yaml":!0,mode:e.mode,resource:e.value,errors:e.errors},on:{error:function(a){return e.errors=a},finish:e.save,cancel:e.done}},[t("div",{staticClass:"row mt-40 mb-20"},[t("div",{staticClass:"col span-12 mb-20"},[t("h3",[e._v(e._s(e.t("elemental.osimage.create.configuration")))]),t("NameNsDescription",{attrs:{mode:e.mode,"description-hidden":!0,namespaced:!1},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)]),e.value.spec?t("div",{staticClass:"row mb-20"},[t("div",{staticClass:"col span-6 mb-20"},[t("h3",[e._v(e._s(e.t("elemental.osimage.create.spec")))]),t("LabeledSelect",{staticClass:"mb-20",attrs:{"data-testid":"cluster-target",label:e.t("elemental.osimage.create.targetCluster.label"),placeholder:e.t("elemental.osimage.create.targetCluster.placeholder",null,!0),mode:e.mode,options:e.clusterTargetOptions,multiple:!0},on:{input:function(a){return e.handleClusterTargetChange(a)}},model:{value:e.clusterTargets,callback:function(a){e.clusterTargets=a},expression:"clusterTargets"}}),t("RadioGroup",{staticClass:"mb-20",attrs:{"data-testid":"upgrade-choice-selector",name:"os-image-mode",options:[!0,!1],labels:[e.t("elemental.osimage.create.radioOptions.osImages"),e.t("elemental.osimage.create.radioOptions.registry")],mode:e.mode},model:{value:e.useManagedOsImages,callback:function(a){e.useManagedOsImages=a},expression:"useManagedOsImages"}}),e.useManagedOsImages?t("div",[t("LabeledSelect",{attrs:{"data-testid":"os-version-box",mode:e.mode,options:e.managedOSVersionOptions,"label-key":"elemental.osimage.create.managedOsImage.label",placeholder:e.t("elemental.osimage.create.managedOsImage.placeholder",null,!0),"option-key":"value"},on:{input:function(a){return e.handleManagedOSVersionNameChange(a)}},model:{value:e.osVersionSelected,callback:function(a){e.osVersionSelected=a},expression:"osVersionSelected"}})],1):t("div",[t("LabeledInput",{attrs:{"data-testid":"os-image-box",label:e.t("elemental.osimage.create.osImage.label"),placeholder:e.t("elemental.osimage.create.osImage.placeholder",null,!0),mode:e.mode},model:{value:e.value.spec.osImage,callback:function(a){e.$set(e.value.spec,"osImage","string"===typeof a?a.trim():a)},expression:"value.spec.osImage"}})],1)],1)]):e._e()]):t("Loading")},n=[],l=t("15ca"),i=t("fd5f"),o=t("305c"),r=t("8e93"),c=t("466b"),d=t("3c8c"),m=t("e143"),u=t("a8b9"),h=t("da25"),v=t("907c"),p=t("c41f"),b=t("a655");const g="_***_";var f={name:"ManagedOsImagesEditView",components:{Loading:l["a"],LabeledInput:r["a"],LabeledSelect:c["a"],CruResource:i["a"],NameNsDescription:d["a"],RadioGroup:m["a"]},mixins:[o["a"]],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){const e={};e.rancherClusters=this.$store.dispatch("management/findAll",{type:v["a"].RANCHER_CLUSTER}),e.osGroups=this.$store.dispatch("management/findAll",{type:p["c"].MANAGED_OS_IMAGES}),e.osVersions=this.$store.dispatch("management/findAll",{type:p["c"].MANAGED_OS_VERSIONS}),e.osVersionChannels=this.$store.dispatch("management/findAll",{type:p["c"].MANAGED_OS_VERSION_CHANNELS});const a=await Object(u["a"])(e);if(this.elementalClusters=Object(b["a"])(a.rancherClusters||[]),this.osGroups=a.osGroups||[],this.osVersions=a.osVersions||[],this.osVersionChannels=a.osVersionChannels||[],this.mode===h["l"]||this.mode===h["s"]){var t,s,n,l,i,o,r;if(null!==(t=this.value)&&void 0!==t&&null!==(s=t.spec)&&void 0!==s&&s.managedOSVersionName)this.osVersionSelected=null===(o=this.value)||void 0===o||null===(r=o.spec)||void 0===r?void 0:r.managedOSVersionName,this.useManagedOsImages=!0;else this.useManagedOsImages=!1;if(null!==(n=this.value)&&void 0!==n&&null!==(l=n.spec)&&void 0!==l&&null!==(i=l.clusterTargets)&&void 0!==i&&i.length){var c,d;const e=[];null===(c=this.value)||void 0===c||null===(d=c.spec)||void 0===d||d.clusterTargets.forEach(a=>{e.push(a.clusterName)}),this.clusterTargets=e}}},data(){return{elementalClusters:[],osGroups:[],osVersions:[],osVersionChannels:[],clusterTargets:[],useManagedOsImages:!0,osVersionSelected:""}},computed:{clusterTargetOptions(){const e=Object(b["b"])(this.elementalClusters,this.osGroups);return e.map(e=>({label:e.name,value:e.name}))},managedOSVersionOptions(){const e=[];return this.osVersionChannels.forEach(a=>{const t=this.osVersions.filter(e=>{var t,s,n,l;const i=null===(t=e.metadata)||void 0===t?void 0:t.ownerReferences.find(e=>{var t,s,n;return e.name===a.name&&(null===(t=this.value)||void 0===t||null===(s=t.metadata)||void 0===s?void 0:s.namespace)===(null===(n=a.metadata)||void 0===n?void 0:n.namespace)});return i&&Object.keys(i).length&&(null===(s=this.value)||void 0===s||null===(n=s.metadata)||void 0===n?void 0:n.namespace)===(null===(l=e.metadata)||void 0===l?void 0:l.namespace)});t.length&&(e.push({kind:"group",label:this.t("elemental.osimage.create.managedOsImage.channel",{name:a.name}),value:this.t("elemental.osimage.create.managedOsImage.channel",{name:a.name})}),t.forEach(t=>{e.push({label:t.name,value:`${a.name}${g}${t.name}`})}))}),e},isCreate(){return this.mode===h["j"]}},methods:{handleClusterTargetChange(e){this.value.spec.clusterTargets=e.map(e=>({clusterName:e}))},handleManagedOSVersionNameChange(e){this.value.spec.managedOSVersionName=e.split(g)[1]}}},y=f,C=t("d802"),O=Object(C["a"])(y,s,n,!1,null,null,null);a["default"]=O.exports}}]);
//# sourceMappingURL=elemental-1.1.0.umd.min.edit.js.map